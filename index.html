<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³°æ–‡å–®å­—å¡ - æ¥µé€Ÿç‰ˆ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        :root { --primary: #ff6b6b; --bg: #f8f9fa; }
        body { font-family: 'PingFang TC', sans-serif; background: var(--bg); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        h1 { color: #2d3436; margin-bottom: 20px; }
        #card-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 20px; width: 100%; max-width: 1100px; }
        .card { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 8px 15px rgba(0,0,0,0.05); text-align: center; cursor: pointer; transition: 0.2s; position: relative; border: 2px solid transparent; -webkit-tap-highlight-color: transparent; }
        .card:active { transform: scale(0.95); }
        .card.playing { border-color: var(--primary); }
        .thai-word { font-size: 2.5em; margin: 15px 0; color: #2d3436; }
        .chinese-define { font-size: 1.2em; color: #636e72; }
        .lesson-tag { position: absolute; top: 15px; right: 15px; background: #ffeaa7; color: #d63031; padding: 2px 8px; border-radius: 10px; font-size: 0.8em; font-weight: bold; }
        .loading { margin-top: 100px; color: #999; }
    </style>
</head>
<body>

    <h1>ğŸ‡¹ğŸ‡­ æ³°æ–‡å–®å­—ç·´ç¿’</h1>
    <div id="card-container" class="loading">æ­£åœ¨æ¥µé€Ÿè¼‰å…¥ä¸­...</div>

    <script>
        // ä½ æä¾›çš„ CSV ç¶²å€
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSHyMhwwJ12txyfcuAao1MsSR2K2WM61nYGqmSs-ub4Nm8BXmSGtF8h2tOXGJpqIhgLeBV35Im6C8ua/pub?gid=0&single=true&output=csv';

        const audioPlayer = new Audio();

        function init() {
            Papa.parse(CSV_URL, {
                download: true,
                header: true, // è‡ªå‹•æŠŠè©¦ç®—è¡¨ç¬¬ä¸€åˆ—æ¨™é¡Œç•¶ key
                skipEmptyLines: true,
                complete: function(results) {
                    renderCards(results.data);
                },
                error: function() {
                    document.getElementById('card-container').innerHTML = "âŒ è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¢ºèªç¶²è·¯é€£ç·šã€‚";
                }
            });
        }

        function renderCards(words) {
            const container = document.getElementById('card-container');
            container.innerHTML = '';
            container.classList.remove('loading');

            words.forEach(item => {
                // æ’é™¤ç©ºè¡Œæˆ–æ¨™é¡Œä¸ç¬¦çš„æƒ…æ³
                if (!item.word) return;

                const card = document.createElement('div');
                card.className = 'card';
                
                // æ’­æ”¾é‚è¼¯
                card.onclick = () => {
                    if (item.audioURL && item.audioURL.trim() !== "") {
                        // ç§»é™¤å…¶ä»–å¡ç‰‡çš„æ’­æ”¾ç‹€æ…‹
                        document.querySelectorAll('.card').forEach(c => c.classList.remove('playing'));
                        card.classList.add('playing');
                        
                        audioPlayer.src = item.audioURL;
                        audioPlayer.load();
                        audioPlayer.play().catch(e => console.log("æ’­æ”¾è¢«æ””æˆª"));
                    }
                };

                card.innerHTML = `
                    <div class="lesson-tag">L${item.lesson || ''}</div>
                    <div class="thai-word">${item.word}</div>
                    <div class="chinese-define">${item.define}</div>
                    <div style="margin-top:10px; opacity: ${item.audioURL ? 1 : 0.1}">ğŸ”Š</div>
                `;
                container.appendChild(card);
            });
        }

        // ç•¶éŸ³æª”æ’­æ”¾çµæŸï¼Œç§»é™¤å¡ç‰‡é«˜äº®
        audioPlayer.onended = () => {
            document.querySelectorAll('.card').forEach(c => c.classList.remove('playing'));
        };

        init();
    </script>
</body>
</html>